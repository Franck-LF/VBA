Sub VerifierOuCreerFichierEtFeuille()
    Dim xlApp As Object
    Dim wb As Object
    Dim ws As Object
    Dim cheminFichier As String
    Dim feuilleExiste As Boolean
    
    ' D√©finir le chemin complet du fichier
    cheminFichier = "C:\Users\VotreNom\Documents\synthese.xlsx" ' üîÅ √Ä adapter
    
    ' Cr√©er une instance d'Excel
    On Error Resume Next
    Set xlApp = GetObject(, "Excel.Application")
    If xlApp Is Nothing Then Set xlApp = CreateObject("Excel.Application")
    On Error GoTo 0
    
    xlApp.Visible = False
    
    ' V√©rifier si le fichier existe
    If Dir(cheminFichier) = "" Then
        ' Le fichier n'existe pas, on le cr√©e
        Set wb = xlApp.Workbooks.Add
        Set ws = wb.Sheets(1)
        ws.Name = "feuille16"
        wb.SaveAs cheminFichier
    Else
        ' Le fichier existe, on l'ouvre
        Set wb = xlApp.Workbooks.Open(cheminFichier)
        
        ' V√©rifier si la feuille "feuille16" existe
        feuilleExiste = False
        For Each ws In wb.Sheets
            If LCase(ws.Name) = "feuille16" Then
                feuilleExiste = True
                Exit For
            End If
        Next
        
        ' Si elle n'existe pas, la cr√©er
        If Not feuilleExiste Then
            Set ws = wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count))
            ws.Name = "feuille16"
        End If
    End If
    
    ' Sauvegarder et fermer
    wb.Save
    wb.Close
    xlApp.Quit
    
    ' Lib√©rer la m√©moire
    Set ws = Nothing
    Set wb = Nothing
    Set xlApp = Nothing
End Sub

Le code fonctionne m√™me depuis Outlook si les r√©f√©rences Excel ne sont pas activ√©es, car on utilise CreateObject.

Tu peux ajuster les options pour rendre Excel visible (xlApp.Visible = True) si tu veux voir ce qui se passe.

______________________________________
